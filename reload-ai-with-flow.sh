#!/bin/bash

echo "==========================================="
echo "üîÑ Reloading AI with Booking Flow Knowledge"
echo "==========================================="
echo ""

cd "/Users/tanujapaunikar/Desktop/Health Care"

# Clear caches
echo "Clearing cache..."
php artisan config:clear
php artisan cache:clear

# Seed booking flow knowledge
echo ""
echo "Adding booking flow knowledge to AI..."
php artisan db:seed --class=BookingFlowKnowledgeSeeder

# Seed additional knowledge (if not already done)
echo ""
echo "Ensuring all knowledge base resources are loaded..."
php artisan db:seed --class=AdditionalKnowledgeSeeder

echo ""
echo "==========================================="
echo "‚úÖ Done! AI now understands booking flow"
echo "==========================================="
echo ""
echo "üéØ What Changed:"
echo ""
echo "1. AI now knows WHEN to show UI components"
echo "   - Shows doctor list when user wants to browse"
echo "   - Shows calendar when user wants to see availability"
echo "   - Shows payment UI for secure transactions"
echo ""
echo "2. AI now knows WHEN to use natural chat"
echo "   - Answers questions naturally (no UI components)"
echo "   - Handles simple confirmations via chat"
echo "   - Extracts info from natural language"
echo ""
echo "3. AI learned complete booking workflows"
echo "   - Doctor appointment flow (8 steps)"
echo "   - Lab test booking flow (6 steps)"
echo "   - When each step needs UI vs chat"
echo ""
echo "==========================================="
echo "üß™ Test These Scenarios:"
echo "==========================================="
echo ""
echo "1. QUESTION (should use natural chat, NO UI):"
echo "   - 'which doctor has better experience with gynaecology?'"
echo "   - 'what is the difference between video and in-person?'"
echo "   - 'how much does an appointment cost?'"
echo "   ‚Üí Expected: Natural answer from knowledge base"
echo ""
echo "2. BROWSING REQUEST (should show UI):"
echo "   - 'show me all available doctors'"
echo "   - 'what time slots are available?'"
echo "   - 'let me see the packages'"
echo "   ‚Üí Expected: Relevant UI component displayed"
echo ""
echo "3. COMPLETE INFO (should use natural chat):"
echo "   - 'book appointment with Dr. Rajesh tomorrow at 10am for myself'"
echo "   ‚Üí Expected: Confirms naturally, skips unnecessary steps"
echo ""
echo "4. STEP-BY-STEP (should be conversational):"
echo "   - 'I want to see a doctor'"
echo "   - 'for my son'"
echo "   - 'new appointment'"
echo "   - 'Dr. Rajesh'"
echo "   ‚Üí Expected: Natural flow with extracted entities"
echo ""
echo "==========================================="
echo ""
echo "üí° The AI should now:"
echo "   ‚úì Answer questions naturally (never show UI for questions)"
echo "   ‚úì Show UI only when user wants to browse or for complex selections"
echo "   ‚úì Extract information from natural language"
echo "   ‚úì Skip unnecessary steps when info is provided"
echo "   ‚úì Maintain natural conversation flow"
echo ""
echo "üåê Test at: http://localhost:3000/booking/"
echo ""
echo "üìã Check logs: tail -f storage/logs/laravel.log"
echo ""
